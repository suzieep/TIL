## 230124

### Kurento 코드 로직 총정리

Controller

req) joinRoom(myUserId,channelId)

1. channelId로 room 가져오기 getRoomByChannelId
   - room 없으면 생성하기 createNewRoomByChannelId
2. 내 outgoingMediaEndpoint 생성하기
   - addIceCandidateFoundListener 붙여서 이벤트 감지될 때마다 IceCandidateResponse 보내기
   - synchronized(webSocketSession)
3. 나 Participant 등록(userId, room, webSocketSession, outgoingMediaEndpoint)
   - outgoingMediaEndpoint 만들기
4. 현재 방에 있는 Participant 찾기
   - participants.forEach(새로운 유저 왔음을 알리기)
   - 나에게 현재 있는 유저 정보 내려주기

req) sdpOffer(myUserId,sdpOfferRequest(userId,sdpOffer))

req) leaveRoom(myUserId)

req)

```java
addIceCandidate(
    myUserId, IceCandidateRequest(userId, CandidateInfo(candidate,sdpMid,sdpMLineIndex)))
```
